To leverage the observation that *anomaly* is a relative concept (i.e., whether a certain pattern can be considered an anomaly depends on the context), we use a threshold to turn anomaly score sequences (i.e., series of temporal windows, anomaly score pairs) generated by the Anomaly Detection Module into a set of anomalous traffic segments, where the threshold is a function of the destination port. Formally, we define the threshold as a mapping $\tau: P \rightarrow \mathbb{R}^{+}$, where `P` is a set of port numbers.

This mechanism leverages what was learned from normal traffic involving the same type of service, recognizing that different types of network services exhibit distinct traffic patterns and are uniquely mapped to specific ports. The threshold for each port `p` can be defined based on the statistical properties of its anomaly score distribution. A common approach is to set the threshold at a certain number of standard deviations above the mean, i.e., $\tau(p) = \mu_p + k \cdot \sigma_p$, where `k` is a constant that determines the anomaly detection sensitivity.

A typical choice for `k` might be 2 or 3, depending on the desired balance between detecting anomalies and minimizing false positives. As the Classification Module can rule out false positives, in this processing stage we are interested in increasing recall; thus, we choose lower values of `k`.
